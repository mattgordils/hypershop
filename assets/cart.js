/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/entrypoints/cart.js":
/*!*********************************!*\
  !*** ./src/entrypoints/cart.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   refreshCart: () => (/* binding */ refreshCart)\n/* harmony export */ });\nconst updateCartCount = () => {\n  const cartCountItems = document.querySelectorAll(\"#cartCount\");\n  console.log(cartCountItems);\n  cartCountItems.forEach((item) => {\n    const newCartCount = document.querySelector(\"#cartHeader\").dataset.cartCount;\n    let prependContent = \"\";\n    let appendContent = \"\";\n    if (newCartCount > 0) {\n      if (item.dataset.emptyHide) {\n        item.classList.remove(\"hidden\");\n      }\n      if (item.dataset.prepend) {\n        prependContent = item.dataset.prepend;\n      }\n      if (item.dataset.append) {\n        appendContent = item.dataset.append;\n      }\n      item.innerHTML = prependContent + newCartCount + appendContent;\n    } else {\n      if (item.dataset.emptyHide) {\n        item.classList.add(\"hidden\");\n      }\n      item.innerHTML = null;\n    }\n  });\n};\nconst refreshCart = (fullRefresh = false) => {\n  const sectionTitle = \"page_cart-panel\";\n  const cartDrawer = document.querySelector(\"#shopify-section-\" + sectionTitle + \" #cartContent\");\n  if (!cartDrawer) {\n    return false;\n  }\n  fetch(window.Shopify.routes.root + \"?sections=\" + sectionTitle).then((res) => res.json()).then((res) => {\n    const currentCartDrawer = document.querySelector(\"#shopify-section-\" + sectionTitle + \" #cartContent\");\n    var el = document.createElement(\"div\");\n    el.innerHTML = res[sectionTitle];\n    const oldCartCount = document.querySelector(\"#shopify-section-\" + sectionTitle + \" #cartHeader\").dataset.cartCount;\n    const newCartCount = el.querySelector(\"#cartHeader\").dataset.cartCount;\n    const oldlineCount = document.querySelectorAll(\"#shopify-section-\" + sectionTitle + \" #cartLineItem\")?.length;\n    const newlineCount = el.querySelectorAll(\"#shopify-section-\" + sectionTitle + \" #cartLineItem\")?.length;\n    if (newCartCount == 0 || oldCartCount == 0 || oldlineCount !== newlineCount) {\n      fullRefresh = true;\n    }\n    fullRefresh = true;\n    if (fullRefresh) {\n      const cartContent = el.querySelector(\"#cartContent\");\n      const updateItems = document.querySelectorAll(\"#shopify-section-\" + sectionTitle + \" #cartUpdate\");\n      const updatedItems = el.querySelectorAll(\"#shopify-section-\" + sectionTitle + \" #cartUpdate\");\n      console.log(cartContent);\n      console.log(updateItems);\n      console.log(updatedItems);\n      currentCartDrawer.outerHTML = cartContent.outerHTML;\n      updateItems?.forEach((item, index) => {\n        if (updatedItems[index]?.innerHTML && item) {\n          item.innerHTML = updatedItems[index].innerHTML;\n        }\n      });\n      updateCartCount();\n    } else {\n      const updateItems = document.querySelectorAll(\"#shopify-section-\" + sectionTitle + \" #cartUpdate\");\n      const updatedItems = el.querySelectorAll(\"#shopify-section-\" + sectionTitle + \" #cartUpdate\");\n      updateItems?.forEach((item, index) => {\n        if (updatedItems[index]?.innerHTML && item) {\n          item.innerHTML = updatedItems[index].innerHTML;\n        }\n      });\n      updateCartCount();\n    }\n  });\n};\nif (!customElements.get(\"cart-remove-item\")) {\n  customElements.define(\n    \"cart-remove-item\",\n    class CartRemoveItem extends HTMLElement {\n      constructor() {\n        super();\n        this.cartRemoveButton = this.querySelector(\".cart-remove-item\");\n        this.cartRemoveButton.addEventListener(\"click\", (event) => {\n          let formData = {\n            updates: {\n              [event.currentTarget.dataset.itemId]: 0\n            }\n          };\n          if (event.currentTarget.dataset.itemId.includes(\", \")) {\n            const variantIds = event?.currentTarget?.dataset?.itemId.split(\", \")?.filter((item) => item !== \"\");\n            const updatesObj = {};\n            if (variantIds.length > 0) {\n              variantIds.forEach((id) => {\n                updatesObj[id] = 0;\n              });\n            }\n            formData = {\n              updates: updatesObj\n            };\n          }\n          fetch(window.Shopify.routes.root + \"cart/update.js\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify(formData)\n          }).then((data) => {\n            refreshCart(true);\n          }).catch((error) => {\n            console.error(\"Error:\", error);\n          });\n        });\n      }\n    }\n  );\n}\nif (!customElements.get(\"cart-quantity-adjust\")) {\n  customElements.define(\n    \"cart-quantity-adjust\",\n    class QuantityAdjust extends HTMLElement {\n      constructor() {\n        super();\n        this.quantityChangeButtons = this.querySelectorAll(\".quantity-change\");\n        this.onQuantityChangeButtonClick = this.onQuantityChangeButtonClick.bind(this);\n        this.quantityChangeButtons.forEach((quantityChangeButton) => {\n          quantityChangeButton.onclick = this.onQuantityChangeButtonClick;\n        });\n      }\n      onQuantityChangeButtonClick(event) {\n        const quantityChangeButton = event.currentTarget;\n        this.getQuantityDivFromChangeButton(quantityChangeButton).classList.add(\n          \"opacity-0\"\n        );\n        const itemId = parseInt(\n          quantityChangeButton.getAttribute(\"data-product-id\")\n        );\n        const itemQuantity = parseInt(\n          quantityChangeButton.getAttribute(\"data-new-quantity\")\n        );\n        let formData = {\n          updates: {\n            [itemId]: itemQuantity\n          }\n        };\n        let successHandler = (response) => {\n          const parent = quantityChangeButton.parentElement;\n          this.getQuantityDivFromChangeButton(quantityChangeButton).innerHTML = itemQuantity;\n          this.getQuantityDivFromChangeButton(\n            quantityChangeButton\n          ).classList.remove(\"opacity-0\");\n          const decreaseQuantityButton = parent.querySelector(\".quantity-down\");\n          decreaseQuantityButton.setAttribute(\n            \"data-new-quantity\",\n            itemQuantity - 1\n          );\n          const increaseQuantityButton = parent.querySelector(\".quantity-up\");\n          increaseQuantityButton.setAttribute(\n            \"data-new-quantity\",\n            itemQuantity + 1\n          );\n          return response.json();\n        };\n        successHandler = successHandler.bind(quantityChangeButton);\n        fetch(window.Shopify.routes.root + \"cart/update.js\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(formData)\n        }).then((data) => successHandler(data)).then((data) => {\n          refreshCart();\n          document.querySelectorAll(\".cart-item-count\").forEach((element) => {\n            element.innerHTML = data.item_count;\n          });\n        }).catch((error) => {\n          console.error(\"Error:\", error);\n        });\n      }\n      getQuantityDivFromChangeButton(buttonDiv) {\n        const parent = buttonDiv.parentElement;\n        return parent.querySelector(\".quantity-current\");\n      }\n    }\n  );\n}\nif (!customElements.get(\"discount-form\")) {\n  customElements.define(\n    \"discount-form\",\n    class DiscountForm extends HTMLElement {\n      constructor() {\n        super();\n        this.input = this.querySelector('input[type=\"text\"]');\n        this.button = this.querySelector(\"button\");\n        this.statusMessage = this.querySelector(\".discount-status\");\n        this.onInputChange = this.onInputChange.bind(this);\n        this.onSubmit = this.onSubmit.bind(this);\n        this.onKeyDown = this.onKeyDown.bind(this);\n        this.updateButtonState();\n        this.input.addEventListener(\"input\", this.onInputChange);\n        this.input.addEventListener(\"keydown\", this.onKeyDown);\n        this.button.addEventListener(\"click\", this.onSubmit);\n      }\n      onKeyDown(event) {\n        if (event.key === \"Enter\") {\n          event.preventDefault();\n          if (!this.button.disabled) {\n            this.onSubmit(event);\n          }\n        }\n      }\n      onInputChange() {\n        this.updateButtonState();\n        if (this.statusMessage) {\n          this.statusMessage.textContent = \"\";\n          this.statusMessage.classList.add(\"hidden\");\n        }\n      }\n      updateButtonState() {\n        const hasValue = this.input.value.trim().length > 0;\n        this.button.disabled = !hasValue;\n        if (hasValue) {\n          this.button.classList.remove(\"opacity-50\", \"cursor-not-allowed\");\n        } else {\n          this.button.classList.add(\"opacity-50\", \"cursor-not-allowed\");\n        }\n      }\n      showStatus(message, isError = false) {\n        if (!this.statusMessage)\n          return;\n        this.statusMessage.textContent = message;\n        this.statusMessage.classList.remove(\"hidden\");\n        if (isError) {\n          this.statusMessage.classList.remove(\"text-green\");\n          this.statusMessage.classList.add(\"text-error\");\n        } else {\n          this.statusMessage.classList.remove(\"text-error\");\n          this.statusMessage.classList.add(\"text-green\");\n        }\n      }\n      onSubmit(event) {\n        event.preventDefault();\n        const discountCode = this.input.value.trim();\n        if (!discountCode)\n          return;\n        this.button.disabled = true;\n        this.button.classList.add(\"opacity-50\");\n        const originalText = this.button.textContent;\n        this.button.textContent = \"Applying...\";\n        let cartBeforeDiscount = null;\n        fetch(window.Shopify.routes.root + \"cart.js\").then((res) => res.json()).then((cart) => {\n          cartBeforeDiscount = cart;\n          return fetch(window.Shopify.routes.root + \"discount/\" + encodeURIComponent(discountCode));\n        }).then(() => {\n          return new Promise((resolve) => setTimeout(resolve, 500));\n        }).then(() => {\n          refreshCart(true);\n          return fetch(window.Shopify.routes.root + \"cart.js\");\n        }).then((res) => res.json()).then((cart) => {\n          this.button.textContent = originalText;\n          this.updateButtonState();\n          if (cart.cart_level_discount_applications && cart.cart_level_discount_applications.length > 0) {\n            const appliedDiscount = cart.cart_level_discount_applications.find(\n              (d) => d.title.toLowerCase() === discountCode.toLowerCase()\n            );\n            if (appliedDiscount) {\n              this.showStatus(`Discount code \"${discountCode}\" applied successfully!`);\n              this.input.value = \"\";\n              return;\n            }\n          }\n          let errorMessage = `Discount code \"${discountCode}\" could not be applied.`;\n          if (!cart.items || cart.items.length === 0) {\n            errorMessage += \" Your cart is empty.\";\n          } else if (cartBeforeDiscount && cart.total_price < 100) {\n            errorMessage += \" This discount may require a minimum purchase amount.\";\n          } else if (cart.items && cart.items.length > 0) {\n            errorMessage += \" This code may be invalid, expired, or not applicable to items in your cart.\";\n          } else {\n            errorMessage += \" Please check the code and try again.\";\n          }\n          this.showStatus(errorMessage, true);\n        }).catch((error) => {\n          console.error(\"Error applying discount:\", error);\n          this.button.textContent = originalText;\n          this.updateButtonState();\n          this.showStatus(\"Error applying discount code. Please check your connection and try again.\", true);\n        });\n      }\n    }\n  );\n}\nif (!customElements.get(\"discount-remove\")) {\n  customElements.define(\n    \"discount-remove\",\n    class DiscountRemove extends HTMLElement {\n      constructor() {\n        super();\n        this.button = this.querySelector(\"button\");\n        this.onRemove = this.onRemove.bind(this);\n        this.button.addEventListener(\"click\", this.onRemove);\n      }\n      onRemove(event) {\n        event.preventDefault();\n        this.button.disabled = true;\n        this.button.classList.add(\"opacity-50\");\n        console.log(\"Removing discount...\");\n        fetch(window.Shopify.routes.root + \"cart/update.js\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            discount: \"\"\n            // Empty string removes the discount\n          })\n        }).then((response) => response.json()).then((data) => {\n          console.log(\"Discount removed:\", data);\n          refreshCart(true);\n          this.button.disabled = false;\n          this.button.classList.remove(\"opacity-50\");\n        }).catch((error) => {\n          console.error(\"Error removing discount:\", error);\n          this.button.disabled = false;\n          this.button.classList.remove(\"opacity-50\");\n          refreshCart(true);\n        });\n      }\n    }\n  );\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVEsSUFBSSxxQkFBcUIsSUFBSTtBQUdyQyxzQkFBWSxJQUFJO0FBR2hCLGVBQUssT0FBTyxXQUFXO0FBQ3ZCLGVBQUssT0FBTyxVQUFVLE9BQU8sWUFBWTtBQUFBLFFBQzNDLENBQUMsRUFDQSxNQUFNLENBQUMsVUFBVTtBQUNoQixrQkFBUSxNQUFNLDRCQUE0QixLQUFLO0FBRy9DLGVBQUssT0FBTyxXQUFXO0FBQ3ZCLGVBQUssT0FBTyxVQUFVLE9BQU8sWUFBWTtBQUd6QyxzQkFBWSxJQUFJO0FBQUEsUUFDbEIsQ0FBQztBQUFBLE1BQ0g7QUFBQSxJQUNGO0FBQUEsRUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hvcGlmeS1zdGFydGVyLy4vc3JjL2VudHJ5cG9pbnRzL2NhcnQuanM/MDM3NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBSZWZyZXNoIENhcnRcbmNvbnN0IHVwZGF0ZUNhcnRDb3VudCA9ICgpID0+IHtcbiAgY29uc3QgY2FydENvdW50SXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjY2FydENvdW50JylcbiAgY29uc29sZS5sb2coY2FydENvdW50SXRlbXMpXG4gIGNhcnRDb3VudEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XG4gICAgY29uc3QgbmV3Q2FydENvdW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcnRIZWFkZXInKS5kYXRhc2V0LmNhcnRDb3VudFxuICAgIGxldCBwcmVwZW5kQ29udGVudCA9ICcnXG4gICAgbGV0IGFwcGVuZENvbnRlbnQgPSAnJ1xuICAgIGlmIChuZXdDYXJ0Q291bnQgPiAwKSB7XG4gICAgICBpZiAoaXRlbS5kYXRhc2V0LmVtcHR5SGlkZSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpXG4gICAgICB9XG4gICAgICBpZiAoaXRlbS5kYXRhc2V0LnByZXBlbmQpIHtcbiAgICAgICAgcHJlcGVuZENvbnRlbnQgPSBpdGVtLmRhdGFzZXQucHJlcGVuZFxuICAgICAgfVxuICAgICAgaWYgKGl0ZW0uZGF0YXNldC5hcHBlbmQpIHtcbiAgICAgICAgYXBwZW5kQ29udGVudCA9IGl0ZW0uZGF0YXNldC5hcHBlbmRcbiAgICAgIH1cbiAgICAgIGl0ZW0uaW5uZXJIVE1MID0gcHJlcGVuZENvbnRlbnQgKyBuZXdDYXJ0Q291bnQgKyBhcHBlbmRDb250ZW50XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpdGVtLmRhdGFzZXQuZW1wdHlIaWRlKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJylcbiAgICAgIH1cbiAgICAgIGl0ZW0uaW5uZXJIVE1MID0gbnVsbFxuICAgIH1cbiAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCByZWZyZXNoQ2FydCA9IChmdWxsUmVmcmVzaCA9IGZhbHNlKSA9PiB7XG4gIGNvbnN0IHNlY3Rpb25UaXRsZSA9ICdwYWdlX2NhcnQtcGFuZWwnXG4gIGNvbnN0IGNhcnREcmF3ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2hvcGlmeS1zZWN0aW9uLScgKyBzZWN0aW9uVGl0bGUgKyAnICNjYXJ0Q29udGVudCcpXG4gIGlmICghY2FydERyYXdlcikge1xuICAgIC8vIERvbid0IHJ1biBpZiBubyBjYXJ0IGRyYXdlciBzZWN0aW9uIGlzIGZvdW5kXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArIFwiP3NlY3Rpb25zPVwiICsgc2VjdGlvblRpdGxlKVxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50Q2FydERyYXdlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzaG9waWZ5LXNlY3Rpb24tJyArIHNlY3Rpb25UaXRsZSArICcgI2NhcnRDb250ZW50JylcblxuICAgICAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcbiAgICAgIGVsLmlubmVySFRNTCA9IHJlc1tzZWN0aW9uVGl0bGVdXG4gICAgICBjb25zdCBvbGRDYXJ0Q291bnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2hvcGlmeS1zZWN0aW9uLScgKyBzZWN0aW9uVGl0bGUgKyAnICNjYXJ0SGVhZGVyJykuZGF0YXNldC5jYXJ0Q291bnRcbiAgICAgIGNvbnN0IG5ld0NhcnRDb3VudCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJyNjYXJ0SGVhZGVyJykuZGF0YXNldC5jYXJ0Q291bnRcblxuICAgICAgY29uc3Qgb2xkbGluZUNvdW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3Nob3BpZnktc2VjdGlvbi0nICsgc2VjdGlvblRpdGxlICsgJyAjY2FydExpbmVJdGVtJyk/Lmxlbmd0aFxuICAgICAgY29uc3QgbmV3bGluZUNvdW50ID0gZWwucXVlcnlTZWxlY3RvckFsbCgnI3Nob3BpZnktc2VjdGlvbi0nICsgc2VjdGlvblRpdGxlICsgJyAjY2FydExpbmVJdGVtJyk/Lmxlbmd0aFxuXG4gICAgICBpZiAobmV3Q2FydENvdW50ID09IDAgfHwgb2xkQ2FydENvdW50ID09IDAgfHwgKG9sZGxpbmVDb3VudCAhPT0gbmV3bGluZUNvdW50KSkge1xuICAgICAgICBmdWxsUmVmcmVzaCA9IHRydWVcbiAgICAgIH1cblxuICAgICAgZnVsbFJlZnJlc2ggPSB0cnVlXG5cbiAgICAgIGlmIChmdWxsUmVmcmVzaCkge1xuICAgICAgICAvLyBGdWxsIENhcnQgUmVmcmVzaFxuICAgICAgICBjb25zdCBjYXJ0Q29udGVudCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJyNjYXJ0Q29udGVudCcpXG4gICAgICAgIGNvbnN0IHVwZGF0ZUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3Nob3BpZnktc2VjdGlvbi0nICsgc2VjdGlvblRpdGxlICsgJyAjY2FydFVwZGF0ZScpXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJyNzaG9waWZ5LXNlY3Rpb24tJyArIHNlY3Rpb25UaXRsZSArICcgI2NhcnRVcGRhdGUnKVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coY2FydENvbnRlbnQpXG4gICAgICAgIGNvbnNvbGUubG9nKHVwZGF0ZUl0ZW1zKVxuICAgICAgICBjb25zb2xlLmxvZyh1cGRhdGVkSXRlbXMpXG4gICAgICAgIFxuICAgICAgICBjdXJyZW50Q2FydERyYXdlci5vdXRlckhUTUwgPSBjYXJ0Q29udGVudC5vdXRlckhUTUxcbiAgICAgICAgdXBkYXRlSXRlbXM/LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKHVwZGF0ZWRJdGVtc1tpbmRleF0/LmlubmVySFRNTCAmJiBpdGVtKSB7XG4gICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IHVwZGF0ZWRJdGVtc1tpbmRleF0uaW5uZXJIVE1MXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB1cGRhdGVDYXJ0Q291bnQoKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gVXBkYXRlIENhcnQgUGllY2VzXG4gICAgICAgIGNvbnN0IHVwZGF0ZUl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3Nob3BpZnktc2VjdGlvbi0nICsgc2VjdGlvblRpdGxlICsgJyAjY2FydFVwZGF0ZScpXG4gICAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtcyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJyNzaG9waWZ5LXNlY3Rpb24tJyArIHNlY3Rpb25UaXRsZSArICcgI2NhcnRVcGRhdGUnKVxuICAgICAgICBcbiAgICAgICAgdXBkYXRlSXRlbXM/LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgaWYgKHVwZGF0ZWRJdGVtc1tpbmRleF0/LmlubmVySFRNTCAmJiBpdGVtKSB7XG4gICAgICAgICAgICBpdGVtLmlubmVySFRNTCA9IHVwZGF0ZWRJdGVtc1tpbmRleF0uaW5uZXJIVE1MXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB1cGRhdGVDYXJ0Q291bnQoKVxuICAgICAgfVxuICAgIH0pXG59XG5cbi8vIFJlbW92ZSBDYXJ0IEl0ZW1cbmlmICghY3VzdG9tRWxlbWVudHMuZ2V0KFwiY2FydC1yZW1vdmUtaXRlbVwiKSkge1xuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoXG4gICAgXCJjYXJ0LXJlbW92ZS1pdGVtXCIsXG4gICAgY2xhc3MgQ2FydFJlbW92ZUl0ZW0gZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5jYXJ0UmVtb3ZlQnV0dG9uID0gdGhpcy5xdWVyeVNlbGVjdG9yKFwiLmNhcnQtcmVtb3ZlLWl0ZW1cIik7XG4gICAgICAgIHRoaXMuY2FydFJlbW92ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgbGV0IGZvcm1EYXRhID0ge1xuICAgICAgICAgICAgdXBkYXRlczoge1xuICAgICAgICAgICAgICBbZXZlbnQuY3VycmVudFRhcmdldC5kYXRhc2V0Lml0ZW1JZF06IDAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaXRlbUlkLmluY2x1ZGVzKCcsICcpKSB7XG4gICAgICAgICAgICBjb25zdCB2YXJpYW50SWRzID0gZXZlbnQ/LmN1cnJlbnRUYXJnZXQ/LmRhdGFzZXQ/Lml0ZW1JZC5zcGxpdCgnLCAnKT8uZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPT0gJycpXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVzT2JqID0ge31cbiAgICAgICAgICAgIGlmICh2YXJpYW50SWRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgdmFyaWFudElkcy5mb3JFYWNoKGlkID0+IHtcbiAgICAgICAgICAgICAgICB1cGRhdGVzT2JqW2lkXSA9IDBcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9ybURhdGEgPSB7XG4gICAgICAgICAgICAgIHVwZGF0ZXM6IHVwZGF0ZXNPYmpcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgZmV0Y2god2luZG93LlNob3BpZnkucm91dGVzLnJvb3QgKyBcImNhcnQvdXBkYXRlLmpzXCIsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGZvcm1EYXRhKSxcbiAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgcmVmcmVzaENhcnQodHJ1ZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG59XG5cbi8vIFVwZGF0ZSBDYXJ0IFF1YW50aXR5XG5pZiAoIWN1c3RvbUVsZW1lbnRzLmdldChcImNhcnQtcXVhbnRpdHktYWRqdXN0XCIpKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcbiAgICBcImNhcnQtcXVhbnRpdHktYWRqdXN0XCIsXG4gICAgY2xhc3MgUXVhbnRpdHlBZGp1c3QgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5xdWFudGl0eUNoYW5nZUJ1dHRvbnMgPSB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucXVhbnRpdHktY2hhbmdlXCIpO1xuICAgICAgICB0aGlzLm9uUXVhbnRpdHlDaGFuZ2VCdXR0b25DbGljayA9IHRoaXMub25RdWFudGl0eUNoYW5nZUJ1dHRvbkNsaWNrLmJpbmQodGhpcyk7XG5cbiAgICAgICAgdGhpcy5xdWFudGl0eUNoYW5nZUJ1dHRvbnMuZm9yRWFjaCgocXVhbnRpdHlDaGFuZ2VCdXR0b24pID0+IHtcbiAgICAgICAgICBxdWFudGl0eUNoYW5nZUJ1dHRvbi5vbmNsaWNrID0gdGhpcy5vblF1YW50aXR5Q2hhbmdlQnV0dG9uQ2xpY2s7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBvblF1YW50aXR5Q2hhbmdlQnV0dG9uQ2xpY2soZXZlbnQpIHtcbiAgICAgICAgY29uc3QgcXVhbnRpdHlDaGFuZ2VCdXR0b24gPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICB0aGlzLmdldFF1YW50aXR5RGl2RnJvbUNoYW5nZUJ1dHRvbihxdWFudGl0eUNoYW5nZUJ1dHRvbikuY2xhc3NMaXN0LmFkZChcbiAgICAgICAgICBcIm9wYWNpdHktMFwiXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGl0ZW1JZCA9IHBhcnNlSW50KFxuICAgICAgICAgIHF1YW50aXR5Q2hhbmdlQnV0dG9uLmdldEF0dHJpYnV0ZShcImRhdGEtcHJvZHVjdC1pZFwiKVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBpdGVtUXVhbnRpdHkgPSBwYXJzZUludChcbiAgICAgICAgICBxdWFudGl0eUNoYW5nZUJ1dHRvbi5nZXRBdHRyaWJ1dGUoXCJkYXRhLW5ldy1xdWFudGl0eVwiKVxuICAgICAgICApO1xuXG4gICAgICAgIGxldCBmb3JtRGF0YSA9IHtcbiAgICAgICAgICB1cGRhdGVzOiB7XG4gICAgICAgICAgICBbaXRlbUlkXTogaXRlbVF1YW50aXR5LFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIGxldCBzdWNjZXNzSGFuZGxlciA9IChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHBhcmVudCA9IHF1YW50aXR5Q2hhbmdlQnV0dG9uLnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgdGhpcy5nZXRRdWFudGl0eURpdkZyb21DaGFuZ2VCdXR0b24ocXVhbnRpdHlDaGFuZ2VCdXR0b24pLmlubmVySFRNTCA9XG4gICAgICAgICAgICBpdGVtUXVhbnRpdHk7XG4gICAgICAgICAgdGhpcy5nZXRRdWFudGl0eURpdkZyb21DaGFuZ2VCdXR0b24oXG4gICAgICAgICAgICBxdWFudGl0eUNoYW5nZUJ1dHRvblxuICAgICAgICAgICkuY2xhc3NMaXN0LnJlbW92ZShcIm9wYWNpdHktMFwiKTtcblxuICAgICAgICAgIGNvbnN0IGRlY3JlYXNlUXVhbnRpdHlCdXR0b24gPSBwYXJlbnQucXVlcnlTZWxlY3RvcihcIi5xdWFudGl0eS1kb3duXCIpO1xuICAgICAgICAgIGRlY3JlYXNlUXVhbnRpdHlCdXR0b24uc2V0QXR0cmlidXRlKFxuICAgICAgICAgICAgXCJkYXRhLW5ldy1xdWFudGl0eVwiLFxuICAgICAgICAgICAgaXRlbVF1YW50aXR5IC0gMVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBjb25zdCBpbmNyZWFzZVF1YW50aXR5QnV0dG9uID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoXCIucXVhbnRpdHktdXBcIik7XG4gICAgICAgICAgaW5jcmVhc2VRdWFudGl0eUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgICBcImRhdGEtbmV3LXF1YW50aXR5XCIsXG4gICAgICAgICAgICBpdGVtUXVhbnRpdHkgKyAxXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICAgICAgICB9O1xuICAgICAgICBzdWNjZXNzSGFuZGxlciA9IHN1Y2Nlc3NIYW5kbGVyLmJpbmQocXVhbnRpdHlDaGFuZ2VCdXR0b24pO1xuICAgICAgICBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArIFwiY2FydC91cGRhdGUuanNcIiwge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShmb3JtRGF0YSksXG4gICAgICAgIH0pXG4gICAgICAgICAgLy8gLnRoZW4oKGRhdGEpID0+IHtjb25zb2xlLmxvZyhkYXRhKX0pXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHN1Y2Nlc3NIYW5kbGVyKGRhdGEpKVxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICByZWZyZXNoQ2FydCgpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jYXJ0LWl0ZW0tY291bnRcIikuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICBlbGVtZW50LmlubmVySFRNTCA9IGRhdGEuaXRlbV9jb3VudDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGdldFF1YW50aXR5RGl2RnJvbUNoYW5nZUJ1dHRvbihidXR0b25EaXYpIHtcbiAgICAgICAgY29uc3QgcGFyZW50ID0gYnV0dG9uRGl2LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIHJldHVybiBwYXJlbnQucXVlcnlTZWxlY3RvcihcIi5xdWFudGl0eS1jdXJyZW50XCIpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbn1cblxuLy8gRGlzY291bnQgRm9ybVxuaWYgKCFjdXN0b21FbGVtZW50cy5nZXQoXCJkaXNjb3VudC1mb3JtXCIpKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcbiAgICBcImRpc2NvdW50LWZvcm1cIixcbiAgICBjbGFzcyBEaXNjb3VudEZvcm0gZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5pbnB1dCA9IHRoaXMucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cInRleHRcIl0nKTtcbiAgICAgICAgdGhpcy5idXR0b24gPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xuICAgICAgICB0aGlzLnN0YXR1c01lc3NhZ2UgPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5kaXNjb3VudC1zdGF0dXMnKTtcblxuICAgICAgICAvLyBCaW5kIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgIHRoaXMub25JbnB1dENoYW5nZSA9IHRoaXMub25JbnB1dENoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLm9uU3VibWl0ID0gdGhpcy5vblN1Ym1pdC5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLm9uS2V5RG93biA9IHRoaXMub25LZXlEb3duLmJpbmQodGhpcyk7XG5cbiAgICAgICAgLy8gU2V0IGluaXRpYWwgYnV0dG9uIHN0YXRlXG4gICAgICAgIHRoaXMudXBkYXRlQnV0dG9uU3RhdGUoKTtcblxuICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgIHRoaXMuaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCB0aGlzLm9uSW5wdXRDaGFuZ2UpO1xuICAgICAgICB0aGlzLmlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93bik7XG4gICAgICAgIHRoaXMuYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vblN1Ym1pdCk7XG4gICAgICB9XG5cbiAgICAgIG9uS2V5RG93bihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBpZiAoIXRoaXMuYnV0dG9uLmRpc2FibGVkKSB7XG4gICAgICAgICAgICB0aGlzLm9uU3VibWl0KGV2ZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgb25JbnB1dENoYW5nZSgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICAvLyBDbGVhciBzdGF0dXMgbWVzc2FnZSB3aGVuIHVzZXIgc3RhcnRzIHR5cGluZ1xuICAgICAgICBpZiAodGhpcy5zdGF0dXNNZXNzYWdlKSB7XG4gICAgICAgICAgdGhpcy5zdGF0dXNNZXNzYWdlLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgICAgdGhpcy5zdGF0dXNNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZUJ1dHRvblN0YXRlKCkge1xuICAgICAgICBjb25zdCBoYXNWYWx1ZSA9IHRoaXMuaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDA7XG4gICAgICAgIHRoaXMuYnV0dG9uLmRpc2FibGVkID0gIWhhc1ZhbHVlO1xuXG4gICAgICAgIGlmIChoYXNWYWx1ZSkge1xuICAgICAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wYWNpdHktNTAnLCAnY3Vyc29yLW5vdC1hbGxvd2VkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5idXR0b24uY2xhc3NMaXN0LmFkZCgnb3BhY2l0eS01MCcsICdjdXJzb3Itbm90LWFsbG93ZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBzaG93U3RhdHVzKG1lc3NhZ2UsIGlzRXJyb3IgPSBmYWxzZSkge1xuICAgICAgICBpZiAoIXRoaXMuc3RhdHVzTWVzc2FnZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuc3RhdHVzTWVzc2FnZS50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XG4gICAgICAgIHRoaXMuc3RhdHVzTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblxuICAgICAgICBpZiAoaXNFcnJvcikge1xuICAgICAgICAgIHRoaXMuc3RhdHVzTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCd0ZXh0LWdyZWVuJyk7XG4gICAgICAgICAgdGhpcy5zdGF0dXNNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ3RleHQtZXJyb3InKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnN0YXR1c01lc3NhZ2UuY2xhc3NMaXN0LnJlbW92ZSgndGV4dC1lcnJvcicpO1xuICAgICAgICAgIHRoaXMuc3RhdHVzTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCd0ZXh0LWdyZWVuJyk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgb25TdWJtaXQoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBjb25zdCBkaXNjb3VudENvZGUgPSB0aGlzLmlucHV0LnZhbHVlLnRyaW0oKTtcbiAgICAgICAgaWYgKCFkaXNjb3VudENvZGUpIHJldHVybjtcblxuICAgICAgICAvLyBEaXNhYmxlIGJ1dHRvbiBhbmQgc2hvdyBsb2FkaW5nIHN0YXRlXG4gICAgICAgIHRoaXMuYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5idXR0b24uY2xhc3NMaXN0LmFkZCgnb3BhY2l0eS01MCcpO1xuICAgICAgICBjb25zdCBvcmlnaW5hbFRleHQgPSB0aGlzLmJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICAgICAgdGhpcy5idXR0b24udGV4dENvbnRlbnQgPSAnQXBwbHlpbmcuLi4nO1xuXG4gICAgICAgIC8vIFN0b3JlIHRoZSBjYXJ0IHN0YXRlIGJlZm9yZSBhcHBseWluZyBkaXNjb3VudFxuICAgICAgICBsZXQgY2FydEJlZm9yZURpc2NvdW50ID0gbnVsbDtcblxuICAgICAgICBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArICdjYXJ0LmpzJylcbiAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcbiAgICAgICAgICAudGhlbihjYXJ0ID0+IHtcbiAgICAgICAgICAgIGNhcnRCZWZvcmVEaXNjb3VudCA9IGNhcnQ7XG5cbiAgICAgICAgICAgIC8vIEFwcGx5IGRpc2NvdW50IGNvZGVcbiAgICAgICAgICAgIHJldHVybiBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArICdkaXNjb3VudC8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGRpc2NvdW50Q29kZSkpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIFNob3BpZnkgaGFzIHByb2Nlc3NlZCB0aGUgZGlzY291bnRcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTAwKSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBjYXJ0IHRvIHNob3cgdXBkYXRlZCB0b3RhbHNcbiAgICAgICAgICAgIHJlZnJlc2hDYXJ0KHRydWUpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBkaXNjb3VudCB3YXMgYXBwbGllZCBieSBmZXRjaGluZyBjYXJ0IGFnYWluXG4gICAgICAgICAgICByZXR1cm4gZmV0Y2god2luZG93LlNob3BpZnkucm91dGVzLnJvb3QgKyAnY2FydC5qcycpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgICAgICAgLnRoZW4oY2FydCA9PiB7XG4gICAgICAgICAgICAvLyBSZXNldCBidXR0b24gc3RhdGVcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBkaXNjb3VudCB3YXMgYXBwbGllZFxuICAgICAgICAgICAgaWYgKGNhcnQuY2FydF9sZXZlbF9kaXNjb3VudF9hcHBsaWNhdGlvbnMgJiYgY2FydC5jYXJ0X2xldmVsX2Rpc2NvdW50X2FwcGxpY2F0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGFwcGxpZWREaXNjb3VudCA9IGNhcnQuY2FydF9sZXZlbF9kaXNjb3VudF9hcHBsaWNhdGlvbnMuZmluZChcbiAgICAgICAgICAgICAgICBkID0+IGQudGl0bGUudG9Mb3dlckNhc2UoKSA9PT0gZGlzY291bnRDb2RlLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgaWYgKGFwcGxpZWREaXNjb3VudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N0YXR1cyhgRGlzY291bnQgY29kZSBcIiR7ZGlzY291bnRDb2RlfVwiIGFwcGxpZWQgc3VjY2Vzc2Z1bGx5IWApO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRGlzY291bnQgd2Fzbid0IGFwcGxpZWQgLSBkZXRlcm1pbmUgd2h5XG4gICAgICAgICAgICBsZXQgZXJyb3JNZXNzYWdlID0gYERpc2NvdW50IGNvZGUgXCIke2Rpc2NvdW50Q29kZX1cIiBjb3VsZCBub3QgYmUgYXBwbGllZC5gO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBjYXJ0IGlzIGVtcHR5XG4gICAgICAgICAgICBpZiAoIWNhcnQuaXRlbXMgfHwgY2FydC5pdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlICs9ICcgWW91ciBjYXJ0IGlzIGVtcHR5Lic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDaGVjayBpZiBjYXJ0IHRvdGFsIGlzIHRvbyBsb3cgKGNvbW1vbiBtaW5pbXVtIHB1cmNoYXNlIHJlcXVpcmVtZW50KVxuICAgICAgICAgICAgZWxzZSBpZiAoY2FydEJlZm9yZURpc2NvdW50ICYmIGNhcnQudG90YWxfcHJpY2UgPCAxMDApIHsgLy8gTGVzcyB0aGFuICQxXG4gICAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSAnIFRoaXMgZGlzY291bnQgbWF5IHJlcXVpcmUgYSBtaW5pbXVtIHB1cmNoYXNlIGFtb3VudC4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUgYXJlIGFueSBpdGVtcyB0aGF0IG1pZ2h0IGJlIGV4Y2x1ZGVkXG4gICAgICAgICAgICBlbHNlIGlmIChjYXJ0Lml0ZW1zICYmIGNhcnQuaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgKz0gJyBUaGlzIGNvZGUgbWF5IGJlIGludmFsaWQsIGV4cGlyZWQsIG9yIG5vdCBhcHBsaWNhYmxlIHRvIGl0ZW1zIGluIHlvdXIgY2FydC4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSAnIFBsZWFzZSBjaGVjayB0aGUgY29kZSBhbmQgdHJ5IGFnYWluLic7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuc2hvd1N0YXR1cyhlcnJvck1lc3NhZ2UsIHRydWUpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYXBwbHlpbmcgZGlzY291bnQ6JywgZXJyb3IpO1xuXG4gICAgICAgICAgICAvLyBSZXNldCBidXR0b24gc3RhdGVcbiAgICAgICAgICAgIHRoaXMuYnV0dG9uLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgICAgICAgICAgdGhpcy51cGRhdGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5zaG93U3RhdHVzKCdFcnJvciBhcHBseWluZyBkaXNjb3VudCBjb2RlLiBQbGVhc2UgY2hlY2sgeW91ciBjb25uZWN0aW9uIGFuZCB0cnkgYWdhaW4uJywgdHJ1ZSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICApO1xufVxuXG4vLyBSZW1vdmUgRGlzY291bnRcbmlmICghY3VzdG9tRWxlbWVudHMuZ2V0KFwiZGlzY291bnQtcmVtb3ZlXCIpKSB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcbiAgICBcImRpc2NvdW50LXJlbW92ZVwiLFxuICAgIGNsYXNzIERpc2NvdW50UmVtb3ZlIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuYnV0dG9uID0gdGhpcy5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcblxuICAgICAgICAvLyBCaW5kIGV2ZW50IGhhbmRsZXJcbiAgICAgICAgdGhpcy5vblJlbW92ZSA9IHRoaXMub25SZW1vdmUuYmluZCh0aGlzKTtcblxuICAgICAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJcbiAgICAgICAgdGhpcy5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uUmVtb3ZlKTtcbiAgICAgIH1cblxuICAgICAgb25SZW1vdmUoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBEaXNhYmxlIGJ1dHRvbiBhbmQgYWRkIGxvYWRpbmcgc3RhdGVcbiAgICAgICAgdGhpcy5idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdvcGFjaXR5LTUwJyk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1JlbW92aW5nIGRpc2NvdW50Li4uJyk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIGRpc2NvdW50IGJ5IHNlbmRpbmcgZW1wdHkgc3RyaW5nIHRvIC9jYXJ0L3VwZGF0ZS5qc1xuICAgICAgICBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArICdjYXJ0L3VwZGF0ZS5qcycsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgZGlzY291bnQ6ICcnIC8vIEVtcHR5IHN0cmluZyByZW1vdmVzIHRoZSBkaXNjb3VudFxuICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSlcbiAgICAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Rpc2NvdW50IHJlbW92ZWQ6JywgZGF0YSk7XG5cbiAgICAgICAgICAvLyBSZWZyZXNoIHRoZSBjYXJ0IHRvIHNob3cgdXBkYXRlZCB0b3RhbHNcbiAgICAgICAgICByZWZyZXNoQ2FydCh0cnVlKTtcblxuICAgICAgICAgIC8vIFJlLWVuYWJsZSBidXR0b25cbiAgICAgICAgICB0aGlzLmJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wYWNpdHktNTAnKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGRpc2NvdW50OicsIGVycm9yKTtcblxuICAgICAgICAgIC8vIFJlLWVuYWJsZSBidXR0b25cbiAgICAgICAgICB0aGlzLmJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ29wYWNpdHktNTAnKTtcblxuICAgICAgICAgIC8vIFN0aWxsIHRyeSB0byByZWZyZXNoIGNhcnRcbiAgICAgICAgICByZWZyZXNoQ2FydCh0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICApO1xufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/entrypoints/cart.js\n\n}");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/entrypoints/cart.js"](0,__webpack_exports__,__webpack_require__);
/******/ 	
/******/ })()
;