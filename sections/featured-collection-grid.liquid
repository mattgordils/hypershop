{{ 'slider.css' | asset_url | stylesheet_tag }}
<script src="{{ 'slider.bundle.js' | asset_url }}" defer="defer"></script>

{%- liquid
  assign products_to_show = 4
  assign grid_cols = 'lg:grid-cols-4 md:grid-cols-2'
-%}

<div id="{{ section.id }}" class="featured-collection {{ section.settings.section_margin }}{% if section.settings.color_scheme != "default" %} {{ section.settings.color_scheme }} py-md-vertical{% endif %}">
  <div>
    {%- if section.settings.title != blank -%}
      <div class="page-width px-margin mx-auto flex justify-between items-center gap-y-12 mb-gutter md:mb-gutter flex-col md:flex-row">
        <h2 class="h4 sans text-main">{{ section.settings.collection.title }}: {{ section.settings.title | escape }}</h2>
        <a href="{{ section.settings.collection.url }}"
          class="inline-flex button solid md:w-auto w-full"
          aria-label="{{ 'sections.featured_collection.view_all_label' | t: collection_name: section.settings.collection.title }}"
        >
          Shop All
        </a>
      </div>
    {%- endif -%}

    <ul class="{% if section.settings.mobile_slider == true %}hidden lg:grid{% else %}grid{% endif %} {{ grid_cols }} page-width px-margin gap-x-gutter gap-y-margin">
      {%- for product in section.settings.collection.products limit: products_to_show -%}
        <li>
          {% render 'card-product',
            card_product: product,
            show_secondary_image: section.settings.show_secondary_image,
            show_vendor: section.settings.show_vendor,
            show_rating: section.settings.show_rating,
            show_quick_add: section.settings.enable_quick_add,
            section_id: section.id
          %}
        </li>
      {%- else -%}
        {%- for i in (1..4) -%}
          <li class="flex-1 w-full min-w-[20%]">
            {% render 'card-product',
              card_product: product,
              show_secondary_image: section.settings.show_secondary_image,
              show_vendor: section.settings.show_vendor,
              show_rating: section.settings.show_rating,
              show_quick_add: section.settings.enable_quick_add,
              section_id: section.id
            %}
          </li>
        {%- endfor -%}
      {%- endfor -%}
    </ul>

    {% if section.settings.mobile_slider == true %}
      <div class="lg:hidden px-margin lg:pl-gutter overflow-hidden py-margin -my-margin lg:col-span-7 z-1 relative lg:pl-[30px]">
        <ul
          class="progress-dots featured-collection-slider slide-gap slick-visible-overflow"
          role="list"
          data-slick='{
            "slidesToShow": 2.5,
            "slidesToScroll": 1,
            "dots": true,
            "arrows": true,
            "centerMode": false,
            "infinite": false,
            "responsive": [
              {
                "breakpoint": 1500,
                "settings": { "slidesToShow": 2.25 }
              },
              {
                "breakpoint": 1280,
                "settings": { "slidesToShow": 2 }
              },
              {
                "breakpoint": 1024,
                "settings": { "slidesToShow": 2.5 }
              },
              {
                "breakpoint": 768,
                "settings": { "arrows": false }
              },
              {
                "breakpoint": 675,
                "settings": { "slidesToShow": 1.5, "arrows": false }
              },
              {
                "breakpoint": 550,
                "settings": { "slidesToShow": 1.3, "arrows": false }
              }
            ]
          }'
        >
          {%- for product in section.settings.collection.products limit: products_to_show -%}
            <li role="listitem">
              {% render 'card-product',
                card_product: product,
                show_secondary_image: section.settings.show_secondary_image,
                show_vendor: section.settings.show_vendor,
                show_rating: section.settings.show_rating,
                show_quick_add: section.settings.enable_quick_add,
                section_id: section.id
              %}
            </li>
          {%- else -%}
            {%- for i in (1..4) -%}
              <li role="listitem">
                {% render 'card-product',
                  card_product: product,
                  show_secondary_image: section.settings.show_secondary_image,
                  show_vendor: section.settings.show_vendor,
                  show_rating: section.settings.show_rating,
                  show_quick_add: section.settings.enable_quick_add,
                  section_id: section.id
                %}
              </li>
            {%- endfor -%}
          {%- endfor -%}
        </ul>
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Featured Collection Grid",
  "tag": "section",
  "class": "section featured-collection",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Headline",
      "info": "This will override the collection title"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Subheader",
      "info": "This will override the collection description"
    },
    {
      "type": "checkbox",
      "id": "show_description",
      "label": "Show Collection Description",
      "default": false
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "default": "default",
      "label": "Background Color",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "bg-light-grey",
          "label": "Nude"
        }
      ]
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "checkbox",
      "id": "mobile_slider",
      "label": "Mobile Slider",
      "default": false
    },
    {
      "type": "select",
      "id": "section_margin",
      "default": "mb-v-spacing",
      "label": "Section Margin",
      "info": "This can be used to adjust or remove the space below this section",
      "options": [
        {
          "label": "none",
          "value": "mb-0"
        },
        {
          "label": "Small",
          "value": "mb-v-spacing-sm"
        },
        {
          "label": "Medium",
          "value": "mb-v-spacing"
        },
        {
          "label": "Large",
          "value": "mb-v-spacing-lg"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Featured Collection Grid"
    }
  ]
}
{% endschema %}
