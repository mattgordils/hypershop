{% capture spacing_class %}
  {% render 'util-section-spacing' with space: section.settings.section_spacing %}
{% endcapture %}

<script src="{{ 'pdp.js' | asset_url }}" defer></script>

{% liquid
	assign media_sizes = '(min-width: 768px) 50vw, 100vw'
%}

<div
	id="mainPDP"
	data-product-update="{{ section.id }}"
	class="w-full flex flex-col md:grid md:grid-cols-2 gap-y-margin {{ spacing_class }}"
>
  <div class="w-full flex flex-col gap-gutter" data-dynamic-content>
		{% if product.selected_or_first_available_variant.image != blank %}
			<div class="md:col-span-2">
				{% render 'image' with
					src: product.selected_or_first_available_variant.image,
					loading: 'eager',
					sizes: media_sizes,
					ratio: 1,
					class: 'w-full',
					fetchpriority: 'high'
				%}
			</div>
		{% endif %}
		<div class="hidden md:grid md:grid-cols-2 gap-gutter">
			{%- for image in product.images -%}
				{% render 'image' with
					src: image,
					sizes: media_sizes,
					ratio: 1,
					class: 'w-full'
				%}
			{%- endfor -%}
		</div>
  </div>

  <div class="px-margin">
    <div class="flex flex-col gap-y-v-space-sm sticky top-sticky-top">
			<add-to-cart-form class="flex flex-col gap-y-4">
				{%- if section.blocks != blank -%}
					{%- for block in section.blocks -%}
						{%- case block.type -%}
							{%- when 'type' -%}
								<div {{ block.shopify_attributes }}>
									<p class='h6'>{{ product.type }}</p>
								</div>
							{%- when 'title' -%}
								<div {{ block.shopify_attributes }}>
									<h1>{{ product.title }}</h1>
								</div>
							{%- when 'text' -%}
								<div {{ block.shopify_attributes }}>
									<p class="{{ block.settings.text_style }}">{{ block.settings.text }}</p>
								</div>
							{%- when 'quantity_selector' -%}
								<div {{ block.shopify_attributes }}>
									{% render 'quantity_adjust' with item: product.selected_or_first_available_variant %}
								</div>
							{%- when 'price' -%}
								<div {{ block.shopify_attributes }} data-dynamic-content>
									<p class="body-large">
										{% render 'product_price' with item: product.selected_or_first_available_variant %}
									</p>
								</div>
							{%- when 'variant_picker' -%}
								<div {{ block.shopify_attributes }} data-dynamic-content>
									{% render 'product_option_form' with
										product: product,
										context: 'PDP'
									%}
								</div>
							{%- when 'buy_buttons' -%}
								<div {{ block.shopify_attributes }} data-dynamic-content>
									{% render 'add_to_cart_button' with
										class: "w-full large",
										product: product,
										show_price: block.settings.show_price
									%}
								</div>
							{%- when 'description' -%}
								<div {{ block.shopify_attributes }}>
									<div class="rich-text body-small">
										{{ product.description }}
									</div>
								</div>
							{%- when 'custom_liquid' -%}
								<div {{ block.shopify_attributes }}>
									{{ block.custom_liquid }}
								</div>
							{%- when 'collapsible_tab' -%}
								<div {{ block.shopify_attributes }}>
									{{ block.title }}
									{{ block.text }}
								</div>
							{%- when 'rating' -%}
								<div {{ block.shopify_attributes }}>
									RATING
								</div>
							{%- when '@app' -%}
								<div {{ block.shopify_attributes }}>
									{% render block %}
								</div>
						{%- endcase -%}
					{%- endfor -%}
				{%- endif -%}
			</add-to-cart-form>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Product",
  "blocks": [
    {
			"type": "@app"
		},
		{
      "type": "_headline"
    },
    {
      "type": "_rich-text"
    },
    {
      "type": "_actions"
    },
		{
      "type": "_product-price"
    },
		{
      "type": "_product-qty-input"
    },
		{
      "type": "_product-variant-selector"
    },
		{
      "type": "_product-buy-buttons"
    },
		{
      "type": "_accordion"
    }
  ],
  "settings": [
		{
      "type": "select",
      "id": "section_spacing",
      "default": "medium",
      "label": "Section Spacing",
      "info": "This can be used to adjust or remove the space below this section",
      "options": [
        {
          "label": "None",
          "value": "none"
        },
        {
          "label": "Small",
          "value": "small"
        },
        {
          "label": "Medium",
          "value": "medium"
        },
        {
          "label": "Large",
          "value": "large"
        }
      ]
    }
	]
}
{% endschema %}

